<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - TemucoSoft</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .module-card { cursor: pointer; transition: transform 0.2s; }
        .module-card:hover { transform: scale(1.03); }
        .muted { opacity: 0.7; }
    </style>
</head>
<body class="bg-light">
    <nav class="navbar navbar-dark bg-dark px-3">
        <a class="navbar-brand" href="#">TemucoSoft POS</a>
        <span class="navbar-text text-white">
            {{ request.user.username }} ({{ role_label }})
            <span class="badge bg-warning text-dark ms-2">{{ plan_name }}</span>
        </span>
        <a href="/logout/" class="btn btn-outline-light btn-sm ms-3">Salir</a>
    </nav>

    <div class="container mt-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 class="mb-0">Panel principal</h2>
            <span class="text-muted">Funciones seg칰n rol y plan</span>
        </div>

        <div class="alert alert-info d-flex justify-content-between align-items-center">
            {% if menu_flags.branch_limit %}
                Plan actual: <strong>{{ plan_name }}</strong>. L칤mite de sucursales: {{ menu_flags.branch_limit }}.
            {% else %}
                Plan actual: <strong>{{ plan_name }}</strong>. Sucursales ilimitadas.
            {% endif %}
            {% if not menu_flags.allow_reports %}
                <br>Reportes avanzados disponibles desde <strong>Plan Est치ndar</strong>.
            {% endif %}
            {% if request.user.role == 'cliente_final' %}
                <a class="btn btn-sm btn-primary" href="{% url 'cliente_plan_detail' %}">Mi plan</a>
            {% endif %}
        </div>

        <div class="row g-4">
            {% if request.user.role == 'super_admin' or request.user.role == 'admin_cliente' or request.user.role == 'vendedor' %}
            <div class="col-md-4">
                <div class="card module-card text-white bg-success h-100">
                    <div class="card-body text-center">
                        <h3>游 POS / Ventas</h3>
                        <p>Realizar ventas</p>
                    </div>
                </div>
            </div>
            {% endif %}

            {% if request.user.role == 'super_admin' or request.user.role == 'admin_cliente' or request.user.role == 'gerente' %}
            <div class="col-md-4">
                <div class="card module-card text-white bg-primary h-100">
                    <div class="card-body text-center">
                        <h3>游닍 Productos</h3>
                        <p>Cat치logo</p>
                    </div>
                </div>
            </div>
            {% endif %}

            {% if request.user.role == 'super_admin' or request.user.role == 'admin_cliente' or request.user.role == 'gerente' %}
            <div class="col-md-4">
                <div class="card module-card text-white bg-info h-100">
                    <div class="card-body text-center">
                        <h3>游늵 Inventario</h3>
                        <p>Stock por sucursal</p>
                    </div>
                </div>
            </div>
            {% endif %}

            {% if request.user.role == 'super_admin' or request.user.role == 'admin_cliente' %}
            <div class="col-md-4">
                <div class="card module-card text-white bg-secondary h-100">
                    <div class="card-body text-center">
                        <h3>游끽 Sucursales</h3>
                        <p>Gestionar locales</p>
                    </div>
                </div>
            </div>
            {% endif %}

            {% if menu_flags.allow_reports and (request.user.role == 'super_admin' or request.user.role == 'admin_cliente' or request.user.role == 'gerente') %}
            <div class="col-md-4">
                <div class="card module-card text-white bg-warning h-100">
                    <div class="card-body text-center">
                        <h3>游늳 Reportes</h3>
                        <p>Estad칤sticas</p>
                        {% if menu_flags.allow_advanced_reports %}
                            <span class="badge bg-dark">Avanzados</span>
                        {% else %}
                            <span class="badge bg-light text-dark">Est치ndar</span>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% else %}
            <div class="col-md-4">
                <div class="card module-card bg-light border-muted h-100 muted">
                    <div class="card-body text-center">
                        <h3>游늳 Reportes</h3>
                        <p class="text-muted">Disponible desde Plan Est치ndar</p>
                    </div>
                </div>
            </div>
            {% endif %}

            {% if request.user.role == 'super_admin' or request.user.role == 'admin_cliente' %}
            <div class="col-md-4">
                <div class="card module-card text-white bg-danger h-100">
                    <div class="card-body text-center">
                        <h3>游논 Usuarios</h3>
                        <p>Gesti칩n de personal</p>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</body>
</html>
